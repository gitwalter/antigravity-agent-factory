{
  "id": "hitl-patterns",
  "name": "Human-in-the-Loop Patterns",
  "version": "1.0.0",
  "category": "agent-development",
  "description": "Patterns for human oversight and approval in agent workflows",
  "patterns": {
    "interrupt_before": {
      "description": "Pause before executing action",
      "use_case": "Review before high-stakes actions",
      "implementation": "graph.compile(interrupt_before=['node_name'])",
      "use_when": "When implementing interrupt_before",
      "code_example": "// Example for interrupt_before",
      "best_practices": [
        "Use appropriately for best results.",
        "Monitor results and optimize."
      ]
    },
    "interrupt_after": {
      "description": "Pause after generating proposal",
      "use_case": "Review generated content",
      "implementation": "graph.compile(interrupt_after=['node_name'])",
      "use_when": "When implementing interrupt_after",
      "code_example": "// Example for interrupt_after",
      "best_practices": [
        "Use appropriately for best results.",
        "Monitor results and optimize."
      ]
    },
    "confirmation_levels": {
      "INFO": "Notify only, no response needed",
      "CONFIRM": "Simple yes/no approval",
      "VERIFY": "Type confirmation phrase",
      "description": "Pattern confirmation_levels for hitl-patterns",
      "use_when": "When implementing confirmation_levels",
      "code_example": "// Example for confirmation_levels",
      "best_practices": [
        "Use appropriately for best results.",
        "Monitor results and optimize."
      ]
    },
    "escalation": {
      "levels": [
        "agent",
        "senior_agent",
        "human",
        "manager"
      ],
      "triggers": [
        "low confidence",
        "error",
        "sensitive operation"
      ],
      "pattern": "Progressive escalation based on criteria",
      "description": "Pattern escalation for hitl-patterns",
      "use_when": "When implementing escalation",
      "code_example": "// Example for escalation",
      "best_practices": [
        "Use appropriately for best results.",
        "Monitor results and optimize."
      ]
    },
    "feedback_collection": {
      "types": [
        "correctness",
        "helpfulness",
        "safety"
      ],
      "storage": "LangSmith feedback API",
      "use": "Continuous improvement",
      "description": "Pattern feedback_collection for hitl-patterns",
      "use_when": "When implementing feedback_collection",
      "code_example": "// Example for feedback_collection",
      "best_practices": [
        "Use appropriately for best results.",
        "Monitor results and optimize."
      ]
    }
  },
  "workflow_patterns": {
    "single_approval": {
      "description": "One approval point before execution",
      "flow": "propose -> interrupt -> execute"
    },
    "multi_step": {
      "description": "Approval at each step",
      "flow": "step1 -> approve -> step2 -> approve -> ..."
    },
    "conditional_approval": {
      "description": "Approval only for certain actions",
      "criteria": [
        "cost > threshold",
        "irreversible",
        "external"
      ]
    }
  },
  "implementation": {
    "checkpointing": {
      "required": true,
      "reason": "Resume after human response"
    },
    "thread_id": {
      "required": true,
      "reason": "Identify workflow instance"
    },
    "timeout": {
      "recommended": true,
      "pattern": "Expire pending approvals after duration"
    }
  },
  "best_practices": [
    "Use checkpointing for resumable workflows",
    "Implement timeouts for human responses",
    "Log all human decisions for audit",
    "Provide clear context for decisions",
    "Allow humans to modify, not just approve/reject",
    "Design for async human response"
  ],
  "anti_patterns": [
    {
      "name": "Blocking sync input",
      "problem": "Hangs application",
      "fix": "Use async with timeouts"
    },
    {
      "name": "No context",
      "problem": "Human can't make informed decision",
      "fix": "Provide full details"
    },
    {
      "name": "Binary only",
      "problem": "No way to modify",
      "fix": "Allow editing proposals"
    }
  ],
  "related_skills": [
    "human-in-the-loop",
    "state-management",
    "langgraph-agent-building"
  ],
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Hitl-patterns Knowledge",
  "axiomAlignment": {
    "A1_verifiability": "Patterns are verified through automated testing.",
    "A2_user_primacy": "The user maintains control over all generated output.",
    "A3_transparency": "All automated actions are logged and verifiable.",
    "A4_non_harm": "Strict safety checks prevent destructive operations.",
    "A5_consistency": "Uniform patterns ensure predictable system behavior."
  },
  "related_knowledge": [
    "manifest.json"
  ]
}
