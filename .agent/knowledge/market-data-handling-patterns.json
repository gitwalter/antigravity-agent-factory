{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "id": "market-data-handling-patterns",
  "name": "Market Data Handling Patterns",
  "title": "Market Data Handling Patterns",
  "description": "Tick data, OHLCV, order book, streaming feeds, data normalization, and gap handling",
  "version": "1.0.0",
  "last_updated": "2026-02-10",
  "category": "trading",
  "axiomAlignment": {
    "A1_verifiability": "Point-in-time constraints and canonical schemas enable verifiable data pipelines",
    "A2_user_primacy": "Flexible provider adapters and caching patterns preserve user control over data sources",
    "A3_transparency": "Normalization and validation pipelines make data provenance and quality traceable",
    "A4_non_harm": "Gap handling and sequence validation prevent harmful decisions from bad data",
    "A5_consistency": "Unified patterns across tick, OHLCV, order book, and streaming sources"
  },
  "related_skills": [
    "algo-trading",
    "trading-strategy",
    "backtesting-validation"
  ],
  "related_knowledge": [
    "trading-patterns.json",
    "backtesting-patterns.json",
    "data-pipeline-patterns.json"
  ],
  "patterns": {
    "tick_data_description": {
      "description": "Individual trade or quote events with timestamp, price, size",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# tick_data_description pattern for market-data-patterns\n# Implement based on description: Individual trade or quote events with timestamp, p...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "tick_data_schema": {
      "description": "timestamp, symbol, price, size, side, condition",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# tick_data_schema pattern for market-data-patterns\n# Implement based on description: timestamp, symbol, price, size, side, condition...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "tick_data_when_to_use": {
      "description": "High-frequency, microstructure, order flow analysis",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# tick_data_when_to_use pattern for market-data-patterns\n# Implement based on description: High-frequency, microstructure, order flow analysi...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "tick_data_storage": {
      "description": "Parquet/TimescaleDB, downsampling for history",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# tick_data_storage pattern for market-data-patterns\n# Implement based on description: Parquet/TimescaleDB, downsampling for history...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "tick_data_best_practices": {
      "description": "['Normalize timestamps to exchange timezone', 'Handle tick type (trade vs quote)', 'Compress for storage']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "ohlcv_description": {
      "description": "Open, High, Low, Close, Volume bars at defined intervals",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# ohlcv_description pattern for market-data-patterns\n# Implement based on description: Open, High, Low, Close, Volume bars at defined int...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "ohlcv_intervals": {
      "description": "['1m', '5m', '15m', '1h', '4h', '1D']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "ohlcv_when_to_use": {
      "description": "Technical analysis, strategy backtesting, charting",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# ohlcv_when_to_use pattern for market-data-patterns\n# Implement based on description: Technical analysis, strategy backtesting, charting...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "ohlcv_aggregation": {
      "description": "First=open, Max=high, Min=low, Last=close, Sum=volume",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# ohlcv_aggregation pattern for market-data-patterns\n# Implement based on description: First=open, Max=high, Min=low, Last=close, Sum=vol...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "ohlcv_best_practices": {
      "description": "['Align to exchange session', 'Handle partial bars', 'Store timezone']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "order_book_description": {
      "description": "Bid and ask levels with price and size at each level",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# order_book_description pattern for market-data-patterns\n# Implement based on description: Bid and ask levels with price and size at each lev...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "order_book_structure": {
      "description": "bids: [(price, size), ...], asks: [(price, size), ...], timestamp",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# order_book_structure pattern for market-data-patterns\n# Implement based on description: bids: [(price, size), ...], asks: [(price, size), ...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "order_book_when_to_use": {
      "description": "Market making, liquidity analysis, microstructure",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# order_book_when_to_use pattern for market-data-patterns\n# Implement based on description: Market making, liquidity analysis, microstructure...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "order_book_depth": {
      "description": "Top-of-book (L1) vs L2/L3",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# order_book_depth pattern for market-data-patterns\n# Implement based on description: Top-of-book (L1) vs L2/L3...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "order_book_best_practices": {
      "description": "['Snapshot + delta updates', 'Validate sequence', 'Handle crossed books']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "streaming_feeds_description": {
      "description": "WebSocket or similar for real-time market data",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# streaming_feeds_description pattern for market-data-patterns\n# Implement based on description: WebSocket or similar for real-time market data...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "streaming_feeds_architectures": {
      "description": "['Direct exchange feed', 'Aggregator (Polygon, IEX)', 'Broadcast to workers']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "streaming_feeds_when_to_use": {
      "description": "Live trading, real-time dashboards",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# streaming_feeds_when_to_use pattern for market-data-patterns\n# Implement based on description: Live trading, real-time dashboards...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "streaming_feeds_best_practices": {
      "description": "['Reconnect with backoff', 'Buffer during reconnect', 'Sequence numbers for gaps']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "data_normalization_description": {
      "description": "Unify formats across providers and exchanges",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# data_normalization_description pattern for market-data-patterns\n# Implement based on description: Unify formats across providers and exchanges...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "data_normalization_normalize": {
      "description": "['Timestamp to UTC', 'OHLCV column names', 'Symbol format', 'Price/size precision']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "data_normalization_when_to_use": {
      "description": "Multi-source, multi-asset systems",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# data_normalization_when_to_use pattern for market-data-patterns\n# Implement based on description: Multi-source, multi-asset systems...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "data_normalization_best_practices": {
      "description": "['Canonical schema', 'Provider adapter pattern', 'Validation pipeline']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "gap_handling_description": {
      "description": "Detect and handle missing data: holidays, halts, feed drops",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# gap_handling_description pattern for market-data-patterns\n# Implement based on description: Detect and handle missing data: holidays, halts, f...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "gap_handling_detection": {
      "description": "['Expected bar count', 'Timestamp continuity', 'Volume zero checks']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "gap_handling_strategies": {
      "description": "['Forward fill', 'Interpolate', 'Exclude', 'Alert']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "gap_handling_best_practices": {
      "description": "['Log gaps', 'Document handling policy', 'Backfill when possible']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "point_in_time_description": {
      "description": "Ensure no look-ahead bias; data available only as of timestamp",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# point_in_time_description pattern for market-data-patterns\n# Implement based on description: Ensure no look-ahead bias; data available only as ...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "point_in_time_constraint": {
      "description": "Strategy at t uses only data with timestamp <= t",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# point_in_time_constraint pattern for market-data-patterns\n# Implement based on description: Strategy at t uses only data with timestamp <= t...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "point_in_time_when_to_use": {
      "description": "Backtesting, walk-forward, production",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# point_in_time_when_to_use pattern for market-data-patterns\n# Implement based on description: Backtesting, walk-forward, production...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "point_in_time_best_practices": {
      "description": "['Align bar close to next bar open', 'Delay real-time by 1 bar', 'Use point-in-time datasets']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "data_caching_description": {
      "description": "Cache historical data to avoid repeated fetches",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# data_caching_description pattern for market-data-patterns\n# Implement based on description: Cache historical data to avoid repeated fetches...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "data_caching_approaches": {
      "description": "['Local Parquet/CSV', 'Redis for recent', 'Database with TTL']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "data_caching_when_to_use": {
      "description": "Backtesting, research, cost reduction",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# data_caching_when_to_use pattern for market-data-patterns\n# Implement based on description: Backtesting, research, cost reduction...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "data_caching_best_practices": {
      "description": "['Cache by symbol-date', 'Version cache schema', 'Invalidate on corporate actions']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    }
  },
  "best_practices": [
    "Normalize timestamps to exchange timezone",
    "Handle tick type (trade vs quote)",
    "Compress for storage",
    "Align to exchange session",
    "Handle partial bars",
    "Store timezone",
    "Snapshot + delta updates",
    "Validate sequence"
  ],
  "anti_patterns": [
    "Applying patterns without understanding the underlying concepts",
    "Copy-pasting solutions without adapting to specific context",
    "Over-engineering simple problems with complex patterns"
  ]
}
