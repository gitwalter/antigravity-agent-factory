{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "id": "agent-handoff-patterns",
  "name": "Agent Handoff Patterns",
  "title": "Agent Handoff Patterns",
  "description": "Patterns for handing off tasks between agents in multi-agent systems including delegation, escalation, and routing",
  "version": "1.0.0",
  "last_updated": "2026-02-10",
  "category": "agent-patterns",
  "axiomAlignment": {
    "A1_verifiability": "Handoff logging and traceability enable verification of task flow",
    "A2_user_primacy": "Escalation and human handback preserve user primacy in critical decisions",
    "A3_transparency": "Explicit handoff protocols make agent coordination visible and auditable",
    "A4_non_harm": "Timeout and rollback patterns prevent stuck or orphaned workflows",
    "A5_consistency": "Unified handoff patterns ensure predictable agent coordination"
  },
  "related_skills": [
    "subagent-orchestration",
    "human-in-the-loop",
    "verified-communication"
  ],
  "related_knowledge": [
    "multi-agent-patterns.json",
    "langgraph-workflows.json",
    "agent-coordination.json"
  ],
  "patterns": {
    "delegation_description": {
      "description": "Agent A explicitly delegates a subtask to Agent B with full context; B executes and returns result",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# delegation_description pattern for agent-handoffs\n# Implement based on description: Agent A explicitly delegates a subtask to Agent B ...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "delegation_when_to_use": {
      "description": "Task decomposition, specialist expertise, parallel work",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# delegation_when_to_use pattern for agent-handoffs\n# Implement based on description: Task decomposition, specialist expertise, parallel...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "delegation_handoff_payload": {
      "description": "['task_description', 'context', 'constraints', 'expected_output_format', 'timeout']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "delegation_best_practices": {
      "description": "['Include sufficient context for continuity', 'Set explicit handoff timeouts', 'Define clear acceptance criteria', 'Log handoff for traceability']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "escalation_description": {
      "description": "Agent A cannot resolve and escalates to higher-capability or human agent",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# escalation_description pattern for agent-handoffs\n# Implement based on description: Agent A cannot resolve and escalates to higher-cap...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "escalation_when_to_use": {
      "description": "Uncertainty above threshold, policy violations, user-sensitive decisions, safety concerns",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# escalation_when_to_use pattern for agent-handoffs\n# Implement based on description: Uncertainty above threshold, policy violations, us...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "escalation_escalation_triggers": {
      "description": "['confidence_below_threshold', 'out_of_scope', 'conflict_detected', 'safety_flagged', 'human_approval_required']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "escalation_best_practices": {
      "description": "['Preserve full context in escalation', 'Include reasoning for escalation', 'Define escalation paths clearly', 'Support handback with resolution']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "collaboration_description": {
      "description": "Multiple agents work on same task with shared state; handoffs are incremental contributions",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# collaboration_description pattern for agent-handoffs\n# Implement based on description: Multiple agents work on same task with shared stat...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "collaboration_when_to_use": {
      "description": "Draft-and-review, multi-perspective analysis, iterative refinement",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# collaboration_when_to_use pattern for agent-handoffs\n# Implement based on description: Draft-and-review, multi-perspective analysis, iter...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "collaboration_shared_artifacts": {
      "description": "['blackboard', 'document_buffer', 'state_graph']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "collaboration_best_practices": {
      "description": "['Use versioned shared state', 'Minimize contention points', 'Define contribution boundaries', 'Support conflict resolution']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "routing_description": {
      "description": "Supervisor or router directs incoming request to appropriate agent based on classification",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# routing_description pattern for agent-handoffs\n# Implement based on description: Supervisor or router directs incoming request to a...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "routing_when_to_use": {
      "description": "Multi-domain system, intent classification, load distribution",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# routing_when_to_use pattern for agent-handoffs\n# Implement based on description: Multi-domain system, intent classification, load d...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "routing_routing_strategies": {
      "description": "['llm_based_classification', 'keyword_rules', 'embedding_similarity', 'hybrid']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "routing_best_practices": {
      "description": "['Include fallback agent', 'Log routing decisions', 'Handle ambiguous cases', 'Support re-routing on failure']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "explicit_handoff_with_ack_description": {
      "description": "Sender requests handoff; receiver explicitly accepts before taking ownership",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# explicit_handoff_with_ack_description pattern for agent-handoffs\n# Implement based on description: Sender requests handoff; receiver explicitly accep...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "explicit_handoff_with_ack_when_to_use": {
      "description": "Critical workflows, audit requirements, capacity-aware routing",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# explicit_handoff_with_ack_when_to_use pattern for agent-handoffs\n# Implement based on description: Critical workflows, audit requirements, capacity-a...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "explicit_handoff_with_ack_flow": {
      "description": "['request_handoff', 'receiver_evaluates', 'accept_or_reject', 'context_transfer', 'sender_releases']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "explicit_handoff_with_ack_best_practices": {
      "description": "['Timeout on pending handoffs', 'Support handoff rejection', 'Atomic context transfer', 'Idempotent acceptance']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "implicit_handoff_state_description": {
      "description": "Handoff via shared state; next agent picks up when state indicates readiness",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# implicit_handoff_state_description pattern for agent-handoffs\n# Implement based on description: Handoff via shared state; next agent picks up when...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "implicit_handoff_state_when_to_use": {
      "description": "Pipeline workflows, event-driven systems, decoupled agents",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# implicit_handoff_state_when_to_use pattern for agent-handoffs\n# Implement based on description: Pipeline workflows, event-driven systems, decouple...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "implicit_handoff_state_state_signals": {
      "description": "['task_status', 'output_ready', 'error_flag', 'next_agent_id']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "implicit_handoff_state_best_practices": {
      "description": "['Use locks for state updates', 'Implement visibility timeout', 'Handle orphaned tasks', 'Monitor handoff latency']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "handoff_with_rollback_description": {
      "description": "Support reverting to previous agent if handoff fails or receiver cannot complete",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# handoff_with_rollback_description pattern for agent-handoffs\n# Implement based on description: Support reverting to previous agent if handoff fai...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "handoff_with_rollback_when_to_use": {
      "description": "Resilient workflows, human-in-the-loop, fallback chains",
      "use_when": "Apply when implementing this pattern in your domain context",
      "code_example": "# handoff_with_rollback_when_to_use pattern for agent-handoffs\n# Implement based on description: Resilient workflows, human-in-the-loop, fallback c...",
      "best_practices": [
        "Validate implementation against domain requirements",
        "Document the pattern usage and rationale in code"
      ]
    },
    "handoff_with_rollback_rollback_triggers": {
      "description": "['receiver_timeout', 'receiver_rejects', 'quality_check_fails']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    },
    "handoff_with_rollback_best_practices": {
      "description": "['Preserve sender state until confirmed', 'Define rollback depth limit', 'Log rollback events', 'Support partial rollback']",
      "use_when": "See description for when to apply this pattern.",
      "code_example": "See description for when to apply this pattern.",
      "best_practices": [
        "Review and validate implementation against domain requirements",
        "Review and validate implementation against domain requirements"
      ]
    }
  },
  "best_practices": [
    "Include sufficient context for continuity",
    "Set explicit handoff timeouts",
    "Define clear acceptance criteria",
    "Log handoff for traceability",
    "Preserve full context in escalation",
    "Include reasoning for escalation",
    "Define escalation paths clearly",
    "Support handback with resolution"
  ],
  "anti_patterns": [
    "Applying patterns without understanding the underlying concepts",
    "Copy-pasting solutions without adapting to specific context",
    "Over-engineering simple problems with complex patterns"
  ]
}
